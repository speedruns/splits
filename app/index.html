<!DOCTYPE html>
<html>
  <head>
    <script src="./lib/rivets.js"></script>
    <script src="./lib/_.js"></script>
    <script src="./lib/sprintf.js"></script>
    <script src="./lib/mousetrap.js"></script>

    <script src="./formatters/time_formatters.js"></script>
    <link rel="stylesheet" href="./style/base.scss">

    <script>
      const {ComponentLoader} = require('../lib');
      ComponentLoader.load(document, 'timer');
      ComponentLoader.load(document, 'segments');
      ComponentLoader.load(document, 'best_segment');
    </script>
  </head>

  <body>
    <div id="wrap">
      <timer run="run"></timer>
      <segments run="run"></segments>
      <best-segment segment="run.current_segment"></best-segment>
    </div>
  </body>

  <script>
    const $ = document.querySelectorAll.bind(document);

    const {Run, FileIO} = require('../lib');

    let context = {
      run: new Run()
    };

    let $view_bind = rivets.bind($('#wrap')[0], context);



    Mousetrap.bind('space', function() { context.run.start_or_resume(); });
    Mousetrap.bind('p', function() { context.run.pause(); });
    Mousetrap.bind('s', function() { context.run.stop(); });
    Mousetrap.bind('n', function() { context.run.split(); });
    Mousetrap.bind('r', function() { context.run.reset(); });
    Mousetrap.bind('m', function() { context.run.unsplit(); });
    Mousetrap.bind('mod+s', function() { FileIO.save_run(context.run); });
    Mousetrap.bind('mod+o', function() {
      context.run = FileIO.open_run();
    });
  </script>
</html>

